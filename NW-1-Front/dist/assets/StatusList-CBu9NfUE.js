import{u as E,b as R,a as z,c as U,r as b,n as H,o as K,q,d as r,e as n,f as t,i as c,z as P,A as W,B as m,s as N,x as G,F as v,h as T,w as J,g as O,t as d,C as Q,j as C,D as X,E as Y,R as Z}from"./index-BkCgF55l.js";const tt=t("header",{class:"pt-8 pb-8 flex justify-center"},[t("h1",{class:"mb-4 text-4xl text-center font-extrabold leading-none tracking-tight text-[rgb(63,77,204)] sm:text-4xl md:text-5xl lg:text-6xl dark:text-white"},[Q(" IT-Bangmod"),t("span",{class:"text-gray-900 dark:text-white"}," Kradan Kanban")])],-1),et={class:"flex justify-center w-auto"},st={class:"max-h-screen dark:bg-gray-800 flex justify-center"},ot={class:"w-full max-w-screen-lg px-8"},at={class:"flex pb-2 gap-2 justify-between"},rt=t("button",{class:"itbkk-button-home bg-slate-100 px-6 py-2 rounded-lg text-lg font-bold hover:scale-110 duration-200 text-black hover:bg-[#0062ff] hover:text-[#f0f0f0]"},"Home",-1),nt={class:"relative max-h-[27em] bg-[rgba(0,0,0,0.5)] hide overflow-x-auto shadow-md sm:rounded-lg"},it={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 table-fixed"},lt=t("thead",{class:"text-lg text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 sticky top-0 z-10"},[t("tr",null,[t("th",{class:"px-6 py-3 w-1/12"},"Id"),t("th",{class:"px-6 py-3 w-1/6"},"Name"),t("th",{class:"px-6 py-3 w-[20%]"},"Description"),t("th",{class:"px-[68px] py-3 w-1/6"},"Action")])],-1),ct={class:"font-semibold"},dt={class:"px-6 py-4 text-gray-900 whitespace-nowrap dark:text-white"},ut={class:"itbkk-status-name px-6 py-4 text-gray-900 whitespace-nowrap dark:text-white truncate"},ft={class:"itbkk-status-description px-6 py-4 max-w-xs truncate text-gray-900 whitespace-nowrap dark:text-white"},gt={key:0,class:"text-gray-400 italic"},ht={key:1},bt={key:0,class:"px-6 py-4"},xt=["onClick"],pt=["onClick"],mt={key:1,class:"px-6 py-4"},vt={key:0,class:"fixed top-0 left-0 w-full h-full bg-gray-900 bg-opacity-70 flex justify-center items-center text-white scale-125 z-50"},kt={class:"itbkk-message bg-gray-800 p-4 rounded-lg w-96 border-[4px] border-[#37373D]"},wt=t("h3",{class:"text-[#FFC745] font-bold text-lg"},"Delete Status with Transfer",-1),yt=t("hr",null,null,-1),_t={class:"text-center overflow-hidden"},St=t("p",null,"Deleting this status will transfer its tasks to another status.",-1),Nt=t("label",{for:"transferStatus",class:"block text-sm font-medium text-gray-300"},"Transfer tasks to:",-1),Tt=["value"],Ct={class:"flex justify-center mt-4"},Dt={key:1,class:"fixed top-0 left-0 w-full h-full bg-gray-900 bg-opacity-70 flex justify-center items-center text-white scale-125 z-50"},Mt={class:"itbkk-message bg-gray-800 p-4 rounded-lg w-96 border-[4px] border-[#37373D]"},$t=t("h3",{class:"text-[#FFC745] font-bold text-lg"},"Confirm Delete",-1),Ft=t("hr",null,null,-1),At={class:"text-center overflow-hidden"},jt={class:"flex justify-center mt-4"},Vt={__name:"StatusList",setup(It){const k=E().getTasks(),x=R(),l=x.getStatuses(),s=z(),w=U(),y=async()=>{try{const e=await C("/nw1/api//v2/statuses");l.value=e}catch(e){console.error("Failed to fetch status:",e)}},D=async()=>{try{const e=await C("/nw1/api//v2/tasks");k.value=e}catch(e){console.error("Failed to fetch tasks:",e)}},u=b(!1),p=b(!1),_=()=>{u.value=!1},f=()=>{p.value=!1},M=()=>{u.value=!1},$=e=>{if(e.name.toLowerCase().includes("no status")){s.setNotificationMessage("Cannot edit status named 'No Status'"),s.setShowNotification(!0),s.setNotificationType("error");return}w.push({name:"EditStatus",params:{id:e.id}})},i=b({id:"",name:"",modal:!1}),F=async e=>{try{const o=await X("/nw1/api//v2/statuses",e);o===200?(l.value=l.value.filter(h=>h.id!==e),s.setNotificationMessage(`The status "${i.value.name}" is deleted successfully`),s.setShowNotification(!0),s.setNotificationType("success"),_()):o===404?(console.error(`Failed to delete status with ID ${e}. Status does not exist.`),s.setNotificationMessage(`An error occurred deleting the status "${i.value.name}"`),s.setShowNotification(!0),s.setNotificationType("error"),_()):console.error(`Failed to delete status with ID ${e} HTTP status: ${o}`)}catch(o){console.error(`Failed to delete status with ID ${e}:`,o)}},A=e=>{const o=l.value.find(a=>a.id===e);if(!o){console.error(`Status with ID ${e} not found.`);return}if(o.name==="No Status"){s.setNotificationMessage("Cannot delete status named 'No Status'"),s.setShowNotification(!0),s.setNotificationType("error");return}k.value.some(a=>a.status.id===o.id)?j(o):I(o)},j=e=>{i.value=e,p.value=!0},I=e=>{i.value=e,u.value=!0},g=b({id:"",name:"",description:""}),B=async()=>{try{const e=await Y("/nw1/api//v2/statuses",i.value.id,g.value.id);e===200?(x.removeStatuses(i.value),x.addStatus(g.value),s.setNotificationMessage("Transfer and delete operation successful"),s.setShowNotification(!0),s.setNotificationType("success"),f(),y()):(console.error("Failed to transfer and delete status:",e.statusText),s.setNotificationMessage("An error occurred during the transfer and delete operation"),s.setShowNotification(!0),s.setNotificationType("error"),f())}catch(e){console.error("Error transferring and deleting status:",e),s.setNotificationMessage("An error occurred during the transfer and delete operation"),s.setShowNotification(!0),s.setNotificationType("error"),f()}},L=H(()=>l.value.filter(e=>e.id!==i.value.id));return K(()=>{y(),D()}),(e,o)=>{const h=q("RouterLink");return r(),n(v,null,[tt,t("div",et,[c(s).showNotification?(r(),P(W,{key:0,message:c(s).notificationMessage},null,8,["message"])):m("",!0)]),t("div",st,[t("div",ot,[t("div",at,[t("div",null,[N(h,{to:{name:"TaskList"}},{default:G(()=>[rt]),_:1})]),t("div",null,[t("button",{onClick:o[0]||(o[0]=a=>c(w).push({name:"AddStatus"})),class:"itbkk-button-add bg-green-400 px-6 py-2 rounded-lg text-lg font-bold hover:scale-110 duration-200 text-white hover:bg-green-500 hover:text-[#f0f0f0] focus:ring-4 focus:outline-none focus:ring-green-300"},"Add Status")])]),t("div",nt,[t("table",it,[lt,t("tbody",ct,[(r(!0),n(v,null,T(c(l),(a,S)=>(r(),n("tr",{key:S,class:"itbkk-item bg-white transition hover:translate-x-4 duration-300 ease-in-out text-[1.2em]"},[t("td",dt,d(S+1),1),t("td",ut,d(a.name),1),t("td",ft,[a.description?(r(),n("span",ht,d(a.description),1)):(r(),n("span",gt,"No description is provided."))]),a.name!=="Done"?(r(),n("td",bt,[t("button",{onClick:V=>$(a),class:"itbkk-button-edit px-5 py-2.5 sm:mb-2 lg:mb-0 mr-2 text-sm font-medium text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"}," Edit",8,xt),t("button",{onClick:V=>A(a.id),class:"itbkk-button-delete px-5 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Delete",8,pt)])):(r(),n("td",mt))]))),128))])])])])]),p.value?(r(),n("div",vt,[t("div",kt,[wt,yt,t("div",_t,[St,Nt,J(t("select",{id:"transferStatus",name:"transferStatus","onUpdate:modelValue":o[1]||(o[1]=a=>g.value.id=a),class:"mt-1 block w-full p-2 rounded-md bg-gray-700 text-gray-300"},[(r(!0),n(v,null,T(L.value,a=>(r(),n("option",{key:a.id,value:a.id},d(a.name),9,Tt))),128))],512),[[O,g.value.id]])]),t("div",Ct,[t("button",{class:"itbkk-button-confirm btn bg-green-600 hover:bg-green-500 border-0 mr-4 flex-grow hover:scale-105 duration-150 text-white",onClick:o[2]||(o[2]=a=>B(i.value.id))},"Delete with Transfer"),t("button",{class:"itbkk-button-cancel btn bg-red-500 hover:bg-red-600 border-0 flex-grow hover:scale-105 duration-200 text-white",onClick:f},"Cancel")])])])):m("",!0),u.value?(r(),n("div",Dt,[t("div",Mt,[$t,Ft,t("div",At,[t("p",null,'Are you sure you want to delete the status "'+d(i.value.name)+'"?',1)]),t("div",jt,[t("button",{class:"itbkk-button-confirm btn bg-green-600 hover:bg-green-500 border-0 mr-4 flex-grow hover:scale-105 duration-150 text-white",onClick:o[3]||(o[3]=a=>F(i.value.id))},"Confirm"),t("button",{class:"itbkk-button-cancel btn bg-red-500 hover:bg-red-600 border-0 flex-grow hover:scale-105 duration-200 text-white",onClick:M},"Cancel")])])])):m("",!0),N(c(Z))],64)}}};export{Vt as default};
